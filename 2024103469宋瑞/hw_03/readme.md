# 项目简要说明 (README)

## 1. 实现目标 (Project Goals)

本项目旨在利用深度学习技术，解决 **2018 Data Science Bowl** 的细胞核分割问题。代码的核心目标是：

*   **模型训练**: 基于 **U-Net** 架构，训练一个能够准确识别并分割出图像中细胞核区域的模型。
*   **结果预测**: 加载训练好的模型，对新的测试图像进行预测，生成像素级的分割掩码 (Mask)。
*   **格式转换**: 将模型输出的分割结果处理成Kaggle竞赛要求的**实例分割**格式（即区分每一个细胞核），并编码为 `RLE` (Run-Length Encoding)。

## 2. 主要思路 (Core Approach)

项目流程遵循“数据-模型-训练-预测”的思路，关键技术点如下：

*   **数据处理**:
    *   实现一个自定义 `Dataset`，在加载数据时将一个图像对应的**多个细胞核掩码文件合并成一个单一的二值图**。
    *   使用 `albumentations` 库对训练数据进行**在线数据增强**（如旋转、翻转），以提升模型泛化能力。

*   **模型选择**:
    *   采用经典的 **U-Net** 网络。其“编码器-解码器”结构和“跳跃连接”（Skip Connection）设计，能有效结合图像的深层语义信息和浅层细节信息，非常适合生物医学图像的精确分割。

*   **训练策略**:
    *   使用 `BCEWithLogitsLoss` 作为损失函数，`Adam` 作为优化器。
    *   引入**学习率动态调度器** (`ReduceLROnPlateau`)，根据验证集指标自动调整学习率。
    *   通过 **TensorBoard** 可视化监控训练过程中的关键指标（如损失和IoU）。

*   **预测与后处理**:
    *   模型输出的是**语义分割**图（所有细胞核为同一类）。
    *   通过**连通域分析** (`skimage.label`) 将语义分割图转换为**实例分割**图，从而区分出每一个独立的细胞核。
    *   对分割结果进行**后处理**（如填充孔洞、移除小噪点），以优化最终掩码的质量。
    *   最后，将每个实例的掩码编码为 **RLE** 格式，生成提交文件。